# AFA办公小程序 MVP 需求文档

## 介绍

AFA办公小程序是一个综合性的办公通行管理系统，旨在为租务管理方、商户和访客提供便捷的通行管理服务。系统包含租务PC端管理后台、商户PC端管理后台和访客小程序三个主要组成部分，实现对办公空间的智能化通行管理。

MVP版本将专注于核心的通行管理功能，包括基础的商户管理、员工管理、访客预约和通行码生成等核心业务流程。

## 需求

### 需求 1 - 租务管理后台

**用户故事：** 作为租务管理员，我希望能够管理商户和空间信息，以便有效控制和监督整个办公区域的通行权限。

#### 验收标准

1. WHEN 租务管理员登录系统 THEN 系统 SHALL 显示商户管理界面
2. WHEN 租务管理员添加新商户 THEN 系统 SHALL 保存商户基本信息并生成商户ID
3. WHEN 租务管理员编辑商户信息 THEN 系统 SHALL 更新商户资料并记录修改日志
4. WHEN 租务管理员停用商户 THEN 系统 SHALL 禁用该商户下所有员工的通行权限
5. WHEN 租务管理员管理空间信息 THEN 系统 SHALL 支持项目、场地、楼层的层级管理
6. WHEN 租务管理员设置商户权限 THEN 系统 SHALL 将通行权限分配给指定商户

### 需求 2 - 商户管理后台

**用户故事：** 作为商户管理员，我希望能够管理本商户的员工和访客，以便控制谁可以进入我们的办公区域。

#### 验收标准

1. WHEN 商户管理员登录系统 THEN 系统 SHALL 显示商户专属的管理界面
2. WHEN 商户管理员添加员工 THEN 系统 SHALL 创建员工账号并分配基础通行权限
3. WHEN 商户管理员批量导入员工 THEN 系统 SHALL 支持Excel文件导入并验证数据格式
4. WHEN 商户管理员设置员工权限 THEN 系统 SHALL 根据商户拥有的权限范围分配给员工
5. WHEN 商户管理员审批访客申请 THEN 系统 SHALL 生成临时通行码并发送给访客
6. WHEN 商户管理员查看访客记录 THEN 系统 SHALL 显示该商户相关的所有访客申请和通行记录

### 需求 3 - 访客小程序

**用户故事：** 作为访客，我希望能够通过小程序预约访问和获取通行码，以便顺利进入办公区域。

#### 验收标准

1. WHEN 访客打开小程序 THEN 系统 SHALL 提供微信授权登录选项
2. WHEN 访客选择身份类型 THEN 系统 SHALL 区分普通访客和商户员工身份
3. WHEN 访客填写预约申请 THEN 系统 SHALL 验证必填信息并提交审批
4. WHEN 访客预约获得批准 THEN 系统 SHALL 生成临时通行码并推送通知
5. WHEN 访客到达预约时间 THEN 系统 SHALL 在申请详情页显示可用的通行码
6. WHEN 访客出示通行码 THEN 系统 SHALL 验证码的有效性和使用次数

### 需求 4 - 员工小程序功能

**用户故事：** 作为商户员工，我希望能够通过小程序申请成为正式员工并使用通行码，以便日常进出办公区域。

#### 验收标准

1. WHEN 新员工提交申请 THEN 系统 SHALL 收集基本信息并发送给商户管理员审批
2. WHEN 员工申请获得批准 THEN 系统 SHALL 自动创建正式员工账号
3. WHEN 正式员工登录小程序 THEN 系统 SHALL 显示员工专属的通行码界面
4. WHEN 员工查看通行码 THEN 系统 SHALL 显示实时更新的二维码
5. WHEN 员工具有审批权限 THEN 系统 SHALL 允许其审批访客预约申请

### 需求 5 - 通行验证系统

**用户故事：** 作为系统管理员，我希望系统能够提供可靠的通行验证接口，以便与硬件设备集成实现自动化通行控制。

#### 验收标准

1. WHEN 硬件设备扫描通行码 THEN 系统 SHALL 验证码的有效性和权限范围
2. WHEN 通行验证成功 THEN 系统 SHALL 返回允许通行的响应并记录通行日志
3. WHEN 通行验证失败 THEN 系统 SHALL 返回拒绝通行的响应并记录失败原因
4. WHEN 系统记录通行日志 THEN 系统 SHALL 包含时间、人员、设备、方向等关键信息
5. IF 通行码超过使用次数限制 THEN 系统 SHALL 拒绝通行并标记码为已失效
6. IF 通行码超过有效时间 THEN 系统 SHALL 自动失效并拒绝通行

### 需求 6 - 基础数据管理

**用户故事：** 作为系统管理员，我希望系统能够维护完整的基础数据结构，以便支持复杂的权限管理和通行控制。

#### 验收标准

1. WHEN 系统初始化 THEN 系统 SHALL 创建项目、场地、楼层的层级数据结构
2. WHEN 管理员配置通行规则 THEN 系统 SHALL 支持按项目维度设置不同的规则参数
3. WHEN 系统生成通行码 THEN 系统 SHALL 根据配置的规则设置码的有效期和使用次数
4. WHEN 管理员设置访客类型 THEN 系统 SHALL 在访客预约时提供对应的类型选项
5. IF 商户未设置专属规则 THEN 系统 SHALL 应用默认的通用规则